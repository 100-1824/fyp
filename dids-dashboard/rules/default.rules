# Default Suricata/Snort Rules for DIDS
# These are example rules based on common attack patterns

# ==================== MALWARE DETECTION ====================

alert tcp any any -> any [4444,5555,6666,7777,31337] (msg:"ET MALWARE Common Backdoor Port Connection"; flow:to_server; classtype:trojan-activity; sid:1000001; rev:1; priority:1;)

alert tcp any any -> any any (msg:"ET MALWARE Possible NOP Sled Detected"; content:"|90 90 90 90 90 90 90 90|"; classtype:shellcode-detect; sid:1000002; rev:1; priority:1;)

alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET MALWARE Reverse Shell Command Execution"; content:"sh -i"; nocase; classtype:trojan-activity; sid:1000003; rev:1; priority:1;)

alert tcp any any -> any any (msg:"ET MALWARE Possible Metasploit Payload"; content:"meterpreter"; nocase; classtype:trojan-activity; sid:1000004; rev:1; priority:1;)

# ==================== WEB ATTACKS ====================

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB SQL Injection Attempt - UNION SELECT"; flow:to_server; content:"UNION"; nocase; content:"SELECT"; nocase; distance:0; classtype:web-application-attack; sid:1000010; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB SQL Injection Attempt - OR 1=1"; flow:to_server; content:"OR"; nocase; content:"1=1"; nocase; distance:0; classtype:web-application-attack; sid:1000011; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB SQL Injection Attempt - DROP TABLE"; flow:to_server; content:"DROP"; nocase; content:"TABLE"; nocase; distance:0; classtype:web-application-attack; sid:1000012; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB XSS Attempt - Script Tag"; flow:to_server; content:"<script"; nocase; classtype:web-application-attack; sid:1000020; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB XSS Attempt - JavaScript Protocol"; flow:to_server; content:"javascript:"; nocase; classtype:web-application-attack; sid:1000021; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB XSS Attempt - OnError Handler"; flow:to_server; content:"onerror="; nocase; classtype:web-application-attack; sid:1000022; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB Directory Traversal Attempt"; flow:to_server; content:"../"; classtype:web-application-attack; sid:1000030; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB Command Injection Attempt"; flow:to_server; content:";"; content:"/bin/"; distance:0; classtype:web-application-attack; sid:1000031; rev:1; priority:2;)

alert tcp any any -> any $HTTP_PORTS (msg:"ET WEB PHP Code Injection"; flow:to_server; content:"<?php"; nocase; classtype:web-application-attack; sid:1000032; rev:1; priority:2;)

# ==================== SCANNING & RECONNAISSANCE ====================

alert tcp any any -> any any (msg:"ET SCAN SYN FIN Scan"; flags:SF; classtype:attempted-recon; sid:1000040; rev:1; priority:3;)

alert tcp any any -> any any (msg:"ET SCAN NULL Scan"; flags:0; classtype:attempted-recon; sid:1000041; rev:1; priority:3;)

alert tcp any any -> any any (msg:"ET SCAN XMAS Scan"; flags:FPU; classtype:attempted-recon; sid:1000042; rev:1; priority:3;)

# ==================== NETWORK ATTACKS ====================

alert tcp any any -> any 22 (msg:"ET ATTACK SSH Brute Force Attempt"; flags:S; threshold:type both, track by_src, count 10, seconds 60; classtype:attempted-admin; sid:1000050; rev:1; priority:2;)

alert tcp any any -> any 21 (msg:"ET ATTACK FTP Brute Force Attempt"; flow:to_server; content:"USER"; threshold:type both, track by_src, count 10, seconds 60; classtype:attempted-admin; sid:1000051; rev:1; priority:2;)

alert tcp any any -> any 3389 (msg:"ET ATTACK RDP Connection Attempt"; flags:S; classtype:attempted-admin; sid:1000052; rev:1; priority:3;)

alert tcp any any -> any 445 (msg:"ET ATTACK SMB Connection Attempt"; flow:to_server; classtype:attempted-admin; sid:1000053; rev:1; priority:3;)

# ==================== DNS ATTACKS ====================

alert udp any any -> any 53 (msg:"ET DNS Possible DNS Tunneling - Excessive Query Length"; dsize:>100; classtype:policy-violation; sid:1000060; rev:1; priority:3;)

alert udp any 53 -> any any (msg:"ET DNS Possible DNS Amplification Attack Response"; dsize:>512; classtype:attempted-dos; sid:1000061; rev:1; priority:2;)

# ==================== EXPLOIT ATTEMPTS ====================

alert tcp any any -> any any (msg:"ET EXPLOIT Buffer Overflow Attempt - Long A Pattern"; content:"|41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41|"; classtype:attempted-admin; sid:1000070; rev:1; priority:1;)

alert tcp any any -> any any (msg:"ET EXPLOIT Shellcode Detected - x86 NOP"; content:"|90 90 90 90|"; classtype:shellcode-detect; sid:1000071; rev:1; priority:1;)

alert tcp any any -> any any (msg:"ET EXPLOIT Format String Attack"; content:"%n"; content:"%s"; distance:0; classtype:attempted-admin; sid:1000072; rev:1; priority:2;)

# ==================== POLICY VIOLATIONS ====================

alert tcp $HOME_NET any -> $EXTERNAL_NET 6666 (msg:"ET POLICY IRC Connection Attempt"; flow:to_server; classtype:policy-violation; sid:1000080; rev:1; priority:3;)

alert tcp any any -> any 23 (msg:"ET POLICY Telnet Connection Attempt"; flow:to_server; classtype:policy-violation; sid:1000081; rev:1; priority:3;)

alert tcp any any -> any any (msg:"ET POLICY Cryptocurrency Mining Pool Connection"; content:"stratum+tcp://"; nocase; classtype:policy-violation; sid:1000082; rev:1; priority:3;)

# ==================== DATA EXFILTRATION ====================

alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET EXFIL Large Outbound Transfer"; dsize:>10000; threshold:type both, track by_src, count 100, seconds 60; classtype:policy-violation; sid:1000090; rev:1; priority:2;)

alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ET EXFIL Base64 Encoded Data Transfer"; flow:to_server; content:"POST"; content:"base64"; distance:0; nocase; classtype:policy-violation; sid:1000091; rev:1; priority:3;)

# ==================== BOTNET ACTIVITY ====================

alert tcp any any -> any any (msg:"ET BOTNET IRC Bot Join Command"; flow:to_server; content:"JOIN"; nocase; content:"#"; distance:0; classtype:trojan-activity; sid:1000100; rev:1; priority:2;)

alert tcp any any -> any any (msg:"ET BOTNET Possible C2 Beacon"; flow:to_server; dsize:<100; threshold:type both, track by_src, count 20, seconds 60; classtype:trojan-activity; sid:1000101; rev:1; priority:2;)

# ==================== VULNERABILITY SCANS ====================

alert tcp any any -> any any (msg:"ET SCAN Nmap Service Scan"; flags:A; window:1024; classtype:attempted-recon; sid:1000110; rev:1; priority:3;)

alert tcp any any -> any any (msg:"ET SCAN Vulnerability Scanner User Agent"; flow:to_server; content:"Nessus"; nocase; classtype:attempted-recon; sid:1000111; rev:1; priority:3;)

alert tcp any any -> any any (msg:"ET SCAN OpenVAS Scanner Detected"; flow:to_server; content:"OpenVAS"; nocase; classtype:attempted-recon; sid:1000112; rev:1; priority:3;)
